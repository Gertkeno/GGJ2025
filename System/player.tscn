[gd_scene load_steps=27 format=3 uid="uid://ugfu6pob7c41"]

[ext_resource type="Script" path="res://System/player.gd" id="1_fwsmy"]
[ext_resource type="PackedScene" uid="uid://b4qyratd0pfy8" path="res://System/game_settings.tscn" id="2_6stdy"]
[ext_resource type="PackedScene" uid="uid://bmjwtpdlkxidu" path="res://System/catch_particles.tscn" id="2_40458"]
[ext_resource type="PackedScene" uid="uid://di7kjb7yshrqr" path="res://Player/_Player.glb" id="2_a56bu"]
[ext_resource type="Material" uid="uid://c14wcr4tvi78f" path="res://Bubble/BubbleMat.tres" id="3_1s7s4"]
[ext_resource type="Texture2D" uid="uid://pnktjf1g18vo" path="res://Player/Textures/player_face.png" id="3_twb6u"]
[ext_resource type="Script" path="res://addons/wigglebone/wiggle_bone.gd" id="6_p4kof"]
[ext_resource type="Script" path="res://addons/wigglebone/wiggle_properties.gd" id="7_o5d8f"]
[ext_resource type="Script" path="res://ArcadeTimer/arcade_timer.gd" id="9_dlwh1"]
[ext_resource type="PackedScene" uid="uid://dwmpbi5874ctd" path="res://credits_screen.tscn" id="10_ri4gx"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_bepga"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_w14fs"]
transparency = 1
albedo_texture = ExtResource("3_twb6u")

[sub_resource type="Resource" id="Resource_w0sh2"]
script = ExtResource("7_o5d8f")
mode = 0
stiffness = 0.1
damping = 0.1
gravity = Vector3(0, 0, 0)
length = 0.1
max_distance = 0.1
max_degrees = 60.0

[sub_resource type="SphereShape3D" id="SphereShape3D_cwrt8"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8aeug"]
animation = &"_Player_Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_72ion"]
animation = &"_Player_Crouch"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_qqmed"]
blend_point_0/node = SubResource("AnimationNodeAnimation_8aeug")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_72ion")
blend_point_1/pos = 1.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_u33dc"]
animation = &"_Player_Crouch_Walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vh7sv"]
animation = &"_Player_Walk"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_lkwd0"]

[sub_resource type="AnimationNodeTimeScale" id="AnimationNodeTimeScale_bv4wx"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_oe1qr"]
graph_offset = Vector2(-466.667, 118.667)
nodes/Animation/node = SubResource("AnimationNodeAnimation_vh7sv")
nodes/Animation/position = Vector2(-426.667, 186.667)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_u33dc")
"nodes/Animation 2/position" = Vector2(-426.667, 346.667)
nodes/Crouch/node = SubResource("AnimationNodeBlend2_lkwd0")
nodes/Crouch/position = Vector2(-133.333, 160)
nodes/WalkSpeed/node = SubResource("AnimationNodeTimeScale_bv4wx")
nodes/WalkSpeed/position = Vector2(106.667, 160)
node_connections = [&"Crouch", 0, &"Animation", &"Crouch", 1, &"Animation 2", &"WalkSpeed", 0, &"Crouch", &"output", 0, &"WalkSpeed"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_w17ej"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_bcpwd"]
xfade_time = 0.13
advance_mode = 2
advance_expression = "is_on_floor() and not velocity.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_y64w1"]
xfade_time = 0.13
advance_mode = 2
advance_expression = "is_on_floor() and velocity.is_zero_approx()"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_b3yls"]
states/Idle/node = SubResource("AnimationNodeBlendSpace1D_qqmed")
states/Idle/position = Vector2(316, 103.333)
states/Start/position = Vector2(168, 109.333)
states/Walk/node = SubResource("AnimationNodeBlendTree_oe1qr")
states/Walk/position = Vector2(472, 78)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_w17ej"), "Idle", "Walk", SubResource("AnimationNodeStateMachineTransition_bcpwd"), "Walk", "Idle", SubResource("AnimationNodeStateMachineTransition_y64w1")]

[node name="Player" type="CharacterBody3D" node_paths=PackedStringArray("player_mesh")]
collision_layer = 32
collision_mask = 11
script = ExtResource("1_fwsmy")
catch_particles = ExtResource("2_40458")
player_mesh = NodePath("_Player2/root/Skeleton3D/_Player")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_bepga")

[node name="CameraPivot" type="Node3D" parent="."]

[node name="SpringArm3D" type="SpringArm3D" parent="CameraPivot"]
transform = Transform3D(1, 0, 0, 0, 0.965926, 0.258819, 0, -0.258819, 0.965926, 0, 1.5, 0)
spring_length = 6.5

[node name="Camera3D" type="Camera3D" parent="CameraPivot/SpringArm3D"]
process_mode = 3
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 6.5)

[node name="_Player2" parent="." instance=ExtResource("2_a56bu")]

[node name="root" parent="_Player2" index="0"]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="_Player2/root" index="0"]
bones/0/position = Vector3(-0.355536, 0.690548, 0.00470643)
bones/0/rotation = Quaternion(-0.177637, 0.605513, 0.760633, 0.152438)
bones/1/position = Vector3(0.000180051, 1.12582, 0.0389809)
bones/5/position = Vector3(1.58259e-07, 0.0128212, 0.734079)
bones/5/rotation = Quaternion(0.00939646, 0.704905, 0.70918, 0.00914619)
bones/5/scale = Vector3(1, 1, 1)
bones/6/position = Vector3(1.21307e-09, 0.196829, -3.1025e-09)
bones/6/rotation = Quaternion(0.0726605, 0.0200168, -0.00117867, 0.997155)
bones/7/rotation = Quaternion(0.235086, 0.00974954, 0.000811439, 0.971925)
bones/8/rotation = Quaternion(-0.232093, -0.00657874, -0.00155946, 0.97267)
bones/8/scale = Vector3(1, 1, 1)
bones/9/rotation = Quaternion(-0.48945, 0.507343, 0.509496, 0.493413)
bones/10/rotation = Quaternion(-0.493766, -0.107608, -0.0837945, 0.858833)
bones/10/scale = Vector3(1, 1, 1)
bones/11/rotation = Quaternion(4.69022e-08, 0.141318, -6.84163e-08, 0.989964)
bones/11/scale = Vector3(1, 0.999999, 1)
bones/12/rotation = Quaternion(-3.61712e-08, -1.82393e-08, 0.281415, 0.959586)
bones/13/rotation = Quaternion(-1.93984e-08, 0.000773754, -5.26362e-08, 1)
bones/13/scale = Vector3(1, 1, 1)
bones/14/rotation = Quaternion(-6.89761e-08, -2.04891e-08, -2.40107e-08, 1)
bones/14/scale = Vector3(1, 1, 1)
bones/15/rotation = Quaternion(0.492803, 0.504074, 0.506253, -0.496752)
bones/15/scale = Vector3(1, 1, 1)
bones/16/rotation = Quaternion(-0.496907, 0.149935, 0.0782807, 0.851161)
bones/16/scale = Vector3(1, 1, 1)
bones/17/rotation = Quaternion(7.19059e-08, -0.184335, 7.62965e-08, 0.982864)
bones/17/scale = Vector3(1, 1, 1)
bones/18/rotation = Quaternion(4.27773e-08, -2.14873e-08, -0.211213, 0.97744)
bones/18/scale = Vector3(1, 1, 1)
bones/19/rotation = Quaternion(4.78789e-08, -0.000840694, -4.34508e-08, 1)
bones/19/scale = Vector3(1, 1, 1)
bones/20/rotation = Quaternion(3.68454e-08, 1.39407e-08, -7.82893e-09, 1)
bones/20/scale = Vector3(1, 1, 1)
bones/21/rotation = Quaternion(0.628066, 0.356353, 0.623899, 0.298823)
bones/21/scale = Vector3(1, 0.999997, 1)
bones/22/rotation = Quaternion(-4.9458e-09, -0.0457623, 4.87636e-09, 0.998952)
bones/22/scale = Vector3(1, 1, 1)
bones/23/rotation = Quaternion(-1.70353e-08, -4.53482e-08, 0.512109, 0.858921)
bones/23/scale = Vector3(1, 1, 1)
bones/24/rotation = Quaternion(0.393761, 0.562193, -0.444655, 0.575476)
bones/24/scale = Vector3(1, 1, 1)
bones/25/rotation = Quaternion(-1.02011e-05, 0.930906, 0.36526, -4.00546e-06)
bones/25/scale = Vector3(1, 1, 1)
bones/26/rotation = Quaternion(-1.05736e-08, -0.0584594, -6.24107e-08, 0.99829)
bones/27/rotation = Quaternion(0.694055, -0.00986934, -0.718926, -0.036548)
bones/27/scale = Vector3(1.00001, 1, 0.999991)
bones/28/rotation = Quaternion(6.51609e-09, 0.0862347, 5.34568e-07, 0.996275)
bones/28/scale = Vector3(1, 1, 1)
bones/29/rotation = Quaternion(7.35323e-08, -2.6757e-09, -0.242802, 0.970076)
bones/29/scale = Vector3(1, 1, 1)
bones/30/rotation = Quaternion(0.299037, -0.626717, 0.345181, 0.631389)
bones/30/scale = Vector3(1, 1, 1)
bones/31/rotation = Quaternion(1.49974e-06, 0.839906, 0.542732, 7.43698e-07)
bones/32/rotation = Quaternion(-5.15709e-09, 0.0511523, -7.43221e-08, 0.998691)
bones/33/position = Vector3(-6.37227e-09, 0.0383555, -0.000893652)
bones/33/rotation = Quaternion(0.00307416, -3.30149e-06, 1.82139e-08, 0.999995)
bones/34/position = Vector3(0.0800164, -0.0208855, 0.202176)
bones/34/rotation = Quaternion(0.261206, 0.157325, 0.948054, -0.0906301)
bones/34/scale = Vector3(0.999999, 1.00388, 0.999996)
bones/35/position = Vector3(2.27147e-08, 0.244458, 1.49012e-08)
bones/35/rotation = Quaternion(-2.6077e-08, -5.0403e-07, -1.68789e-08, 1)
bones/36/position = Vector3(0.163461, 0.00081692, -0.000643894)
bones/36/rotation = Quaternion(0.696238, 0.0918722, 0.701881, -0.119063)
bones/36/scale = Vector3(1, 0.99947, 1)
bones/37/rotation = Quaternion(-2.58442e-08, 2.1116e-07, 1.15439e-09, 1)
bones/37/scale = Vector3(1, 1, 1)
bones/38/position = Vector3(0.0876924, -0.00763426, -0.136845)
bones/38/rotation = Quaternion(0.94564, 0.0409073, 0.25997, -0.191068)
bones/38/scale = Vector3(0.949465, 0.945377, 0.949466)
bones/39/position = Vector3(2.17974e-08, 0.244458, 1.11759e-08)
bones/39/rotation = Quaternion(3.72529e-09, -2.30345e-07, 1.69472e-08, 1)
bones/39/scale = Vector3(1, 1, 1)
bones/40/position = Vector3(-0.0731896, -0.0151322, 0.188798)
bones/40/rotation = Quaternion(-0.253206, 0.137823, 0.953718, 0.0855144)
bones/40/scale = Vector3(0.999999, 1.00579, 0.999996)
bones/41/position = Vector3(2.28172e-08, 0.244458, 3.72527e-09)
bones/41/rotation = Quaternion(-7.45059e-09, 6.23651e-07, 9.15627e-09, 1)
bones/42/position = Vector3(-0.16369, 0.00016676, -0.00147423)
bones/42/rotation = Quaternion(0.693498, -0.097581, -0.701036, -0.134484)
bones/42/scale = Vector3(1, 0.99896, 1)
bones/43/rotation = Quaternion(-2.35159e-08, -2.23413e-07, 2.48449e-09, 1)
bones/43/scale = Vector3(1, 1, 1)
bones/44/position = Vector3(-0.090336, -0.0104457, -0.140599)
bones/44/rotation = Quaternion(0.938574, -0.0357747, -0.261429, -0.222384)
bones/44/scale = Vector3(0.924019, 0.917872, 0.92402)
bones/45/position = Vector3(1.23712e-08, 0.244458, -2.6077e-08)
bones/45/rotation = Quaternion(1.61896e-15, 2.76226e-07, -1.26897e-08, 1)
bones/45/scale = Vector3(1, 1, 1)

[node name="_Player" parent="_Player2/root/Skeleton3D" index="1"]
surface_material_override/1 = SubResource("StandardMaterial3D_w14fs")
surface_material_override/2 = ExtResource("3_1s7s4")

[node name="WiggleBone" type="BoneAttachment3D" parent="_Player2/root/Skeleton3D" index="2"]
transform = Transform3D(0.999993, -0.00361903, -6.90327e-06, 0.00361903, 0.999986, 0.00394694, -7.38092e-06, -0.00394693, 0.999992, 5.09686e-05, 1.12696, 0.0390505)
bone_name = "cc_Bubble_1"
bone_idx = 1
script = ExtResource("6_p4kof")
properties = SubResource("Resource_w0sh2")

[node name="AnimationPlayer" parent="_Player2" index="1"]
reset_on_save = false

[node name="NetHitbox" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.6, -1)
collision_layer = 32
collision_mask = 136
monitorable = false
metadata/_edit_group_ = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="NetHitbox"]
shape = SubResource("SphereShape3D_cwrt8")

[node name="HurtTimer" type="Timer" parent="."]
wait_time = 0.8
one_shot = true

[node name="CatchStunTimer" type="Timer" parent="."]
wait_time = 2.0
one_shot = true

[node name="ArcadeTimer" type="Timer" parent="."]
wait_time = 180.0

[node name="Settings" type="CanvasLayer" parent="."]
visible = false

[node name="PanelContainer" type="PanelContainer" parent="Settings"]
anchors_preset = 6
anchor_left = 1.0
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_left = -555.0
offset_top = -96.0
offset_right = -48.0
offset_bottom = 96.0
grow_horizontal = 0
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="Settings/PanelContainer"]
layout_mode = 2
theme_override_constants/margin_left = 6
theme_override_constants/margin_top = 6
theme_override_constants/margin_right = 6
theme_override_constants/margin_bottom = 6

[node name="GameSettings" parent="Settings/PanelContainer/MarginContainer" instance=ExtResource("2_6stdy")]
unique_name_in_owner = true
layout_mode = 2

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../_Player2")
tree_root = SubResource("AnimationNodeStateMachine_b3yls")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../_Player2/AnimationPlayer")
parameters/Idle/blend_position = 0.0
parameters/Walk/Crouch/blend_amount = 0.0
parameters/Walk/WalkSpeed/scale = 1.0

[node name="Time" type="CanvasLayer" parent="."]
visible = false
script = ExtResource("9_dlwh1")

[node name="PanelContainer" type="PanelContainer" parent="Time"]
offset_left = 31.0
offset_top = 31.0
offset_right = 234.0
offset_bottom = 118.0

[node name="MarginContainer" type="MarginContainer" parent="Time/PanelContainer"]
layout_mode = 2
theme_override_constants/margin_left = 6
theme_override_constants/margin_top = 6
theme_override_constants/margin_right = 6
theme_override_constants/margin_bottom = 6

[node name="TimeLabel" type="Label" parent="Time/PanelContainer/MarginContainer"]
layout_mode = 2
size_flags_vertical = 1
theme_override_font_sizes/font_size = 36
text = "Time: 0:00"
horizontal_alignment = 1
vertical_alignment = 1

[node name="GameOver" type="CanvasLayer" parent="."]
visible = false

[node name="CreditsScreen" parent="GameOver" instance=ExtResource("10_ri4gx")]

[connection signal="timeout" from="HurtTimer" to="." method="set_face_idx" binds= [0]]
[connection signal="timeout" from="CatchStunTimer" to="." method="_on_catch_stun_timer_timeout"]
[connection signal="timeout" from="ArcadeTimer" to="." method="_on_arcade_timer_timeout"]
[connection signal="continue_pressed" from="Settings/PanelContainer/MarginContainer/GameSettings" to="." method="_on_game_settings_continue_pressed"]

[editable path="_Player2"]
